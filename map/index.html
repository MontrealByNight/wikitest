<!DOCTYPE html>
<html>
<head>
  <title>Montreal By Night - Interactive Map</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  
  <style>
    body { margin: 0; padding: 0; background: #1a1a1a; font-family: sans-serif; }
    #map { height: 100vh; width: 100%; }
    
    /* Custom Popup Styles for Dark Theme */
    .leaflet-popup-content-wrapper {
      background: #2b2b2b;
      color: #e0e0e0;
      border: 1px solid #444;
      border-radius: 4px;
    }
    .leaflet-popup-tip { background: #2b2b2b; }
    .type-tag {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.8em;
      font-weight: bold;
      text-transform: uppercase;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script src="map_data.js"></script>

  <script>
    // 1. Initialize Map (Center on Montreal)
    var map = L.map('map').setView([45.53, -73.60], 12);

    // 2. Add Dark Mode Tiles (CartoDB Dark Matter)
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map);

    // 3. Define Colors
    function getColor(type) {
      if (type === 'Camarilla') return '#3388ff'; // Blue
      if (type === 'Anarch') return '#ff3333';    // Red
      if (type === 'Hecata') return '#ffa500';    // Orange
      return '#9c27b0';                           // Purple (Contested)
    }

    // 4. Add Markers
    mapLocations.forEach(function(loc) {
      var color = getColor(loc.type);
      
      var marker = L.circleMarker([loc.lat, loc.lng], {
        color: color,
        fillColor: color,
        fillOpacity: 0.7,
        radius: 8,
        weight: 1
      }).addTo(map);

      // Create Popup Content
      var popupContent = `
        <span class="type-tag" style="background:${color}; color:black">${loc.type}</span><br>
        <strong style="font-size:1.1em">${loc.name}</strong><br>
        <div style="margin-top:5px; font-size:0.9em">${loc.desc}</div>
      `;

      marker.bindPopup(popupContent);
    });
  </script>

</body>
</html>
